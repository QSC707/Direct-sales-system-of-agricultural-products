<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>配送预设调试</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="wwwroot/js/axios-config.js"></script>
</head>
<body>
    <h1>配送预设调试测试</h1>
    <div id="output"></div>
    
    <script>
        // 模拟用户登录状态
        const testUser = {
            userId: 4,
            username: 'testfarmer',
            role: 'farmer'
        };
        localStorage.setItem('user', JSON.stringify(testUser));
        localStorage.setItem('token', 'test-token');
        
        // 测试配送预设API
        async function testDeliveryPresets() {
            const output = document.getElementById('output');
            output.innerHTML = '<p>开始测试配送预设API...</p>';
            
            try {
                console.log('正在调用配送预设API...');
                const response = await http.get(`/api/DeliveryPreset/farmer/${testUser.userId}`);
                console.log('API响应:', response);
                
                output.innerHTML += `<p>API调用成功</p>`;
                output.innerHTML += `<pre>${JSON.stringify(response, null, 2)}</pre>`;
                
                if (response && Array.isArray(response)) {
                    output.innerHTML += `<p>找到 ${response.length} 个配送预设</p>`;
                    response.forEach(preset => {
                        output.innerHTML += `<p>- ${preset.presetName} (ID: ${preset.presetId})</p>`;
                    });
                } else {
                    output.innerHTML += `<p>响应格式不正确或没有配送预设</p>`;
                }
            } catch (error) {
                console.error('API调用失败:', error);
                output.innerHTML += `<p style="color: red;">API调用失败: ${error.message}</p>`;
            }
        }
        
        // 页面加载后执行测试
        document.addEventListener('DOMContentLoaded', testDeliveryPresets);
    </script>
</body>
</html> 